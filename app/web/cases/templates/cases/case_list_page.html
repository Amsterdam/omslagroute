{% extends 'base.html' %}
{% load static client_status_tags i18n %}

{% block title %} - Mijn cli&euml;nten{% endblock %}

{% block breadcrumb %}
    <nav class="breadcrumb screen-only" aria-label="Kruimelpad">
        <ol class="breadcrumb-list">
            <li class="breadcrumb-step"><a href="{% url 'home' %}">Home</a></li>
            <li class="breadcrumb-step sr-only" aria-current="location">Mijn cli&euml;nten</li>
        </ol>
    </nav>
{% endblock %}

{% block main %}
<section class="section section--mijn-clienten">
    <h2>Mijn cli&euml;nten</h2>

    <div class="form-field form-field--buttons screen-only">
        <a href="{% url 'create_case' 'basis-gegevens' %}" class="button button--primary">Nieuwe cliënt</a>
    </div>
{#    <div class="form-field form-field--buttons screen-only">#}
{#        <a href="{% url 'create_case' 'aanvraag-omslag-en-urgentie' %}" class="button button--secondary">Nieuwe aanvraag Urgentie onder voorwaarden</a>#}
{#        <a href="{% url 'create_case' 'aanvraag-omklap' %}" class="button button--secondary">Nieuwe aanvraag Voordracht omklap</a>#}
{#    </div>#}
    <p>{{ object_list.paginator.count }}{% if object_list.paginator.count == 1 %} resultaat{% else %} resultaten{% endif %}</p>


    <table class="case-list">
        <thead>
            <tr>
                <th width="150">Cliënt</th>
                <th>Laatste opgeslagen</th>
                <th>Stap in omslagroute</th>
                <th>Status</th>
                <th>Status datum</th>
                <th>Status door</th>
            </tr>
        </thead>
        <tbody>
            {% for object in object_list %}
                {% case_status_list_latest object as case_status_list %}
                <tr>
                    <td>
                        <span class="show-on-mobile">Naam:</span>
                        <a href="{% url 'case' object.id %}">{{ object.client_name }}</a>
                    </td>
                    <td class="help-text">
                        <span class="show-on-mobile">Laatste opgeslagen:</span>
                        {{ object.saved|date:"d-m-y H:i" }}
                    </td>
                    <td>
                        <span class="show-on-mobile">Stap in omslagroute:</span>
                        {% if case_status_list %}
                        <a href="{% url 'update_case' object.id case_status_list.0.form %}">{{ case_status_list.0.form|form_verbose }}</a>
                        {% else %}
                        <span class="u-text-color-grey4">Er is nog geen aanvraag verstuurd voor deze cliënt</span>
                        {% endif %}
                    </td>
                    <td>
                        <span class="show-on-mobile">Status:</span>
                        {% if case_status_list %}
                        <span class="label {% if case_status_list.0.status == 2 %}label--status-disapproved{% elif case_status_list.0.status == 3 %}label--status-approved{% elif case_status_list.0.status == 4 %}label--status-pending{% endif %}">
                            {% if case_status_list.0.status == 1 and not case_status_list.0.is_first_of_statustype %}Opnieuw {% endif %}{{ case_status_list.0.status|status_verbose }}
                        </span>
                        {% else %}
                        {% endif %}
                    </td>
                    <td class="help-text">
                        <span class="show-on-mobile">Status datum:</span>
                        {% if case_status_list %}
                        {{ case_status_list.0.created|date:"d-m-y H:i" }}
                        {% else %}
                        {% endif %}
                    </td>
                    <td class="help-text">
                        <span class="show-on-mobile">Status door:</span>
                        {% if case_status_list %}
                        {{ case_status_list.0.profile.user.username }}
                        {% else %}
                        {% endif %}
                    </td>
                </tr>
            {% endfor %}
        </tbody>
    </table>

    <!-- <table class="case-list table--interactive">
        <thead>
            <tr>
                <th width="200">Naam</th>
                {% for form in FORMS_PROCESSTAP_CHOICES %}
                <th>{{ form.1 }}</th>
                {% endfor %}
            </tr>
        </thead>
        <tbody>
            {% for object in object_list %}
                <tr>
                    <td>
                        <a href="{% url 'case' object.id %}">
                            <span class="show-on-mobile">Naam:</span>
                            {{ object.client_name }}
                        </a>
                    </td>
                    {% for form in FORMS_PROCESSTAP_CHOICES %}
                    <td>
                        {% client_submitted_form object form.0 as case_status %}
                        {% if case_status %}
                        <a href="{% url 'case' object.id %}" aria-hidden="true">
                            {{ case_status.status|status_verbose }} ({{ case_status.created|date:"j b Y H:i" }})
                        </a>
                        <span class="sr-only">{{ case_status.status|status_verbose }} ({{ case_status.created|date:"j b Y H:i" }})</span>
                        {% else %}
                        <a href="{% url 'case' object.id %}" aria-hidden="true">
                            <span>Deze stap is nog niet ingediend</span>
                        </a>
                        {% endif %}
                    </td>
                    {% endfor %}
                </tr>
            {% endfor %}
        </tbody>
    </table> -->
    {% include 'core/pagination.html' with object_list=object_list filter_params='' %}
</section>
{% endblock %}
