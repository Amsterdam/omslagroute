{% extends 'base.html' %}
{% load static i18n html_tags client_status_tags %}

{% block title %} - CliÃ«nt: {{ object.client_name }}{% endblock %}

{% block breadcrumb %}
    <nav class="breadcrumb screen-only" aria-label="Kruimelpad">
        <ol class="breadcrumb-list">
            <li class="breadcrumb-step"><a href="{% url 'home' %}">Home</a></li>
            <li class="breadcrumb-step"><a href="{% url 'cases_by_profile' %}">Mijn cli&euml;nten</a></li>
            <li class="breadcrumb-step sr-only" aria-current="location">{{ object.client_name }}</li>
        </ol>
    </nav>
{% endblock %}

{% block main %}
<section class="section section--client">
    <h1>{{ object.client_name }}</h1>
    <p class="print-only">
        {% language 'nl' %}
            Printdatum: {% now "j F Y H:i" %}
        {% endlanguage %}
    </p>

    <section class="section-details-client">
        <!-- START Client basis gegevens -->
        <div class="details-client details-client--basic">
            <header>
                <h2 class="h3">Basisgegevens</h2>
                <a href="{% url 'update_case' object.id 'basis-gegevens' %}" class="" title="Wijzig cli&euml;ntgegevens">
                    Wijzigen
                </a>
{#                <a href="{% url 'delete_case' object.id %}" class="" title="Verwijder cli&euml;ntgegevens">#}
{#                    Verwijderen#}
{#                </a>#}
            </header>

            <dl>
                {% for k, client_info in object.to_dict.items %}
                {% if not forloop.first and k in basis_gegevens_fields %}
                <div>
                    <dt>{{ client_info.label }}: </dt>
                    <dd>
                        {% if client_info.value|is_date %}
                            {{ client_info.value|str_date_to_date|date:"j b Y" }}
                        {% else %}
                            {{ client_info.value }}
                        {% endif %}
                    </dd>
                </div>
                {% endif %}
                {% endfor %}
            </dl>
        </div>
        <!-- END Client basis gegevens -->


        <!-- START BIJLAGE -->
        <div class="details-client details-client--appendix">
            <header>
                <h2 class="h3">Bijlagen <small>({{ object.document_set.all|length }})</small></h2>
                <a href="{% url 'add_case_document' object.id %}" class="" title="Voeg een nieuwe bijlage toe">
                    Uploaden
                </a>
            </header>

            <ul role="list" class="downloads downloads--logged_in {% if class %}downloads--{{ class }}{% endif %}">
            {% for document in object.document_set.all %}
                {% if forloop.counter0 < 4 %}
                    <li>
                        <div><a href="{% url 'download_case_document' object.id document.id %}" target="_blank"><span>{{ document.name }}</span></a> <span>{{ document.extension }}</span><span> {{ document.uploaded|date:"d-m-y" }} </span></div>
                        <div><a href="{% url 'update_case_document' object.id document.id %}"><span>Wijzigen</span></a></div>
                    </li>
                {% endif %}
            {% endfor %}

            </ul>
            {% if object.document_set.all|length > 3 %}
            <a href="{% url 'case_document_list' object.id %}" class="">Alle bijlages</a>
            {% endif %}
        </div>
    </section>
        <!-- END BIJLAGE -->

    {% block processtappen %}
    <!-- START PROCESSTAPPEN -->
    <!-- TODO: interactie uitzoeken knoppen 'per stap' 'alle gegevens' -->
    <section class="section section--forms">
        <h2 class="h3">Overige gegevens</h2>
        <div class="tab-container">
            <span class="button button--tertiary selected">Per stap</span>
            <a href="{% url 'case_all_data' object.id %}"class="button button--tertiary">Alle gegevens</a>
        </div>
        <ul>
        {% for moment in moment_list %}
        <li>
            <div class="dot dot--large"></div>
                {% client_status object 'basis-gegevens' as status %}
                <strong class="h4">
                    {{ moment.name }} 
                </strong>
                <div class="form-link--statuscontainer">
                {% if moment.form %}
                    <a href="{% url 'update_case' object.id moment.form %}" class="form-link form-link--change">Wijzigen</a>
                {% endif %}
                
                {% if moment.form %}
                    {% client_submitted_form object moment.form as case_version %}
                    {% if case_version %}
                        <a href="{% url 'case_version_form' case_version.id moment.form %}" class="form-link form-link--added">
                            Ingediend {{ case_version.created|date:"d-m-y" }}
                        </a>
                    {% else %}
                        <span class="form-link form-link--added">
                        Nog niet ingediend
                        </span>
                    {% endif %}
                {% endif %}

                <span class="form-link form-link--added">{% if moment.form %}{% client_status object moment.form as status %}{{ status.percentage }}%{% endif %}</span>
            </div>
        </li>
        {% endfor %}
        </ul>
    </section>
    <!-- END PROCESSTAPPEN -->
    {% endblock %}

</section>
{% endblock %}

